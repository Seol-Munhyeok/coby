# NicknamePopup.jsx

이 파일은 COBY 애플리케이션에서 사용자 닉네임을 설정하거나 변경할 수 있는 팝업 컴포넌트인 `NicknameSetup`을 정의합니다. 사용자는 이 팝업을 통해 닉네임을 입력하고 유효성을 검사하며, 중복 확인 후 최종적으로 닉네임을 설정할 수 있습니다.

## 주요 기능

* **닉네임 입력 및 유효성 검사:** 사용자가 닉네임을 입력하고, 실시간으로 유효성 규칙(2~12자 이내, 특정 문자만 허용 등)에 따라 유효성을 검사합니다.
* **닉네임 중복 확인:** 입력된 닉네임의 중복 여부를 서버에 요청하여 확인합니다.
* **닉네임 생성 정책 안내:** 닉네임 생성 시 지켜야 할 정책(욕설 금지, 사칭 금지 등)을 사용자에게 명시적으로 안내합니다.
* **배경 애니메이션:** 로그인 페이지와 유사하게 별(Stars), 별 폭발(StarBurst) 애니메이션이 팝업 뒤에서 재생됩니다.
* **로봇 캐릭터 인터랙션:** 로봇 클릭 시 애니메이션 및 파티클 효과가 발생합니다.
* **토스트 메시지:** 사용자에게 작업 결과나 오류를 간결하게 알리는 토스트 팝업을 표시합니다.
* **닉네임 제출:** 유효하고 중복되지 않은 닉네임을 서버에 제출하고, 성공 시 메인 페이지로 이동합니다.

## 컴포넌트 구조 및 상태 관리

`NicknameSetup` 컴포넌트는 `useState`와 `useRef` 훅을 활용하여 닉네임 입력 상태, 유효성/중복 확인 상태, 메시지 및 애니메이션 요소를 관리합니다.

### State 변수 (`useState`)

* `nickname`: 현재 입력된 닉네임 문자열.
* `isNicknameValid`: 현재 닉네임이 유효성 규칙을 만족하는지 여부 (boolean).
* `isNicknameChecked`: 닉네임 중복 확인을 완료했는지 여부 (boolean).
* `isCheckingDuplicate`: 닉네임 중복 확인 중인지 여부 (boolean).
* `hintMessage`: 닉네임 입력 필드 아래에 표시되는 안내 메시지.
* `hintClass`: `hintMessage`의 스타일 클래스 (예: `text-green-500`, `text-red-500`).
* `toastMessage`: 토스트 팝업에 표시될 메시지.
* `toastType`: 토스트 팝업의 타입 ('info', 'success', 'error').
* `showToast`: 토스트 팝업의 표시 여부 (boolean).

### Ref 변수 (`useRef`)

* `starsRef`: 배경 별들이 렌더링될 컨테이너를 참조합니다.
* `starBurstRef`: 별 폭발 효과가 렌더링될 컨테이너를 참조합니다.
* `robotRef`: 로봇 캐릭터 DOM 요소를 참조합니다.

### 주요 함수 (`function`)

* `createStars()`: 배경 별들을 생성하고 DOM에 추가합니다.
* `createStarBurst(x, y)`: 지정된 좌표에서 별 폭발 애니메이션을 생성합니다.
* `createCodeParticles(x, y)`: 지정된 좌표에서 코드 심볼 파티클 애니메이션을 생성합니다.
* `animateRobot()`: 로봇 캐릭터의 클릭 애니메이션을 실행합니다 (머리 크기, 몸체 색상, 입 움직임 등).
* `handleRobotClick()`: 로봇 클릭 이벤트 발생 시 `animateRobot` 및 `createStarBurst` 함수를 호출합니다.
* `showToastMessage(message, type)`: 특정 메시지와 타입으로 토스트 팝업을 표시합니다.
* `handleNicknameChange(e)`: 닉네임 입력 필드 변경 시 호출됩니다. 닉네임의 유효성을 검사하고 `hintMessage`를 업데이트합니다.
* `handleCheckDuplicate()`: "중복확인" 버튼 클릭 시 호출됩니다. 서버에 닉네임 중복 확인 요청을 보냅니다.
* `handleSubmit()`: "완료" 버튼 클릭 시 호출됩니다. 닉네임의 유효성 및 중복 확인 여부를 최종 검사 후 서버에 닉네임 설정을 요청합니다.

## `useEffect` 훅의 활용

* **배경 애니메이션 초기화:** 컴포넌트 마운트 시 `createStars()` 함수를 호출하여 배경 별 애니메이션을 시작합니다.
* **토스트 메시지 타이머:** `showToast` 상태가 `true`로 변경될 때 일정 시간 후 토스트 메시지를 자동으로 숨깁니다.

## 닉네임 생성 정책

* 2~12자 이내의 한글, 영문, 숫자만 사용 가능합니다.
* 욕설, 비속어, 성적인 표현이 포함된 닉네임은 사용할 수 없습니다.
* 타인을 사칭하거나 혐오를 조장하는 닉네임은 제한됩니다.
* 개인정보(전화번호, 주소 등)가 포함된 닉네임은 사용할 수 없습니다.
* 운영정책에 위배되는 닉네임은 임의로 변경될 수 있습니다.

## CSS 파일

* `NicknamePopup.css`: 컴포넌트의 스타일링 및 애니메이션을 담당하는 CSS 파일입니다.

## 의존성

* `react`, `react-dom`
* `react-router-dom`